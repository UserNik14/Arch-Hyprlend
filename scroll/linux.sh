#!/bin/bash


[[ $TERM = linux ]] && exit


# nascondi cursore
printf '\e[?25l'

# ritardo
delay=0.007

cursor=$'\e[0m‚ñë‚ñë‚ñí‚ñì'


lines=(
    "[?25l[0m[0;37;40m                                            [0m"
    "[0;37;40m       [0;32;40m‚ñü[0;32;40m‚ñá[0;32;40m‚ñÜ[0;32;40m‚ñÖ[0;32;40m‚ññ[0;32;40m [0;32;40m [0;32;40m‚ñÅ[0;32;40m‚ñÇ[0;32;40m‚ñÉ[0;32;40m                           [0m"
    "[0;37;40m      [0;32;40m‚ñü[1;32;42m‚ó¢[1;32;42m‚ñë[1;36;42m‚ñë[0;32;40m‚ñõ[0;32;40m [0;32;40m [0;32;40m‚ñú[1;32;42m‚ñë[0;30;42m‚ñÅ[0;30;42m‚ñÇ[0;32;40m‚ñú[1;32;42m‚ñë[1;32;42m‚ñí[0;32;40m‚ñó[1;32;42m‚ñí[1;32;42m‚ñì[1;32;40m‚ñá[0;32;40m‚ññ[0;32;40m‚ñú[1;32;42m‚ñë[1;32;42m‚ñí[0;32;40m [0;32;40m [0;32;40m‚ñù[1;32;42m‚ñë[1;32;42m‚ñí[0;32;40m‚ñù[1;32;42m‚ñë[1;32;42m‚ñí[0;32;40m‚ñô[0;32;40m [0;32;40m [0;32;40m‚ñü[1;32;42m‚ñì[0;32;40m‚ñõ  [0m"
    "[0;37;40m     [0;32;40m‚ñü[1;32;42m‚ó¢[1;32;42m‚ñì[1;32;42m‚ó§[0;32;40m‚ñõ[0;32;40m [0;32;40m [0;32;40m [0;32;40m [0;32;40m‚ñÇ[0;32;40m‚ñÉ[0;32;40m‚ñÑ[0;32;40m [0;32;40m‚ñà[1;32;42m‚ñë[0;32;40m‚ñõ[0;32;40m‚ñî[0;32;40m‚ñú[1;32;42m‚ñì[1;32;42m‚ñì[0;32;40m [1;32;42m‚ñë[1;32;42m‚ñì[0;32;40m [0;32;40m [0;32;40m [1;32;42m‚ñí[1;32;42m‚ñì[0;32;40m [0;32;40m‚ñù[1;32;42m‚ñë[1;32;42m‚ñí[0;32;40m‚ñô[0;32;40m‚ñü[1;32;42m‚ñì[1;32;40m‚ñõ[0;32;40m   [0m"
    "[0;37;40m    [0;32;40m‚ñü[1;32;42m‚ó¢[1;32;42m‚ñà[1;32;42m‚ó§[0;32;40m‚ñõ[0;32;40m [0;32;40m [0;32;40m [0;32;40m [0;32;40m [0;32;40m‚ñÄ[1;32;42m [1;32;42m‚ñë[0;32;40m‚ñè[0;32;40m‚ñà[1;32;42m‚ñë[0;32;40m [0;32;40m [0;32;40m [1;32;42m‚ñì[1;32;42m‚ñì[0;32;40m [1;32;42m‚ñí[1;32;42m‚ñì[1;35;40m [0;32;40m [0;32;40m [1;32;42m‚ñë[1;32;42m‚ñí[0;32;40m [0;32;40m [0;32;40m‚ñù[1;32;42m‚ñë[1;32;42m‚ñí[1;32;42m‚ñì[0;32;40m‚ñõ[0;32;40m [0;32;40m   [0m"
    "[0;37;40m   [0;32;40m‚ñü[1;32;42m‚ó¢[1;32;42m‚ñì[1;32;42m‚ó§[0;32;40m‚ñõ[0;32;40m [0;32;40m [0;32;40m‚ñù[1;32;42m‚ñë[1;32;42m‚ñí[1;32;42m‚ñì[1;32;40m‚ññ[0;32;40m‚ñù[1;32;42m‚ñí[0;37;40m [1;32;42m‚ñë[1;32;42m‚ñí[0;32;40m [0;32;40m [0;32;40m [1;32;42m‚ñë[1;32;42m‚ñí[0;32;40m [1;32;42m‚ñë[1;32;42m‚ñì[0;32;40m‚ññ[0;32;40m [0;32;40m‚ñó[1;32;42m [1;32;42m‚ñë[0;32;40m [0;32;40m [0;32;40m‚ñü[1;32;42m‚ñí[1;32;42m‚ñì[1;32;42m‚ñì[1;32;40m‚ññ[0;32;40m [0;32;40m   [0m"
    "[0;37;40m  [0;32;40m‚ñü[0;32;40m‚ñà[1;32;42m‚ñë[1;32;42m‚ñë[0;32;40m‚ñà[0;32;40m‚ñà[0;32;40m‚ñà[0;32;40m‚ñà[0;32;40m‚ñà[1;32;42m‚ñë[1;32;42m‚ñë[1;32;42m‚ñí[1;32;42m‚ñí[0;32;40m [0;32;40m‚ñà[0;32;40m‚ñó[1;32;42m‚ñë[1;32;42m‚ñë[0;32;40m [0;32;40m [0;32;40m‚ñü[0;32;40m‚ñà[1;32;42m‚ñë[0;32;40m‚ñô[0;32;40m‚ñú[1;32;42m‚ñí[1;32;42m‚ñì[1;32;42m‚ñí[0;32;40m‚ñõ[1;32;42m [1;32;42m‚ñë[0;32;40m [0;32;40m‚ñü[1;32;42m‚ñì[1;32;40m‚ñõ[1;32;40m‚ñù[1;32;42m‚ñì[1;32;42m‚ñì[1;32;40m‚ññ[0;32;40m   [0m"
    "[0;37;40m                                 [0;32;40m‚ñü[1;32;42m‚ñì[1;32;40m‚ñõ[0;32;40m [0;32;40m [1;32;40m‚ñù[1;32;42m‚ñì[1;32;42m‚ñì[1;32;40m‚ññ  [0m"
    "[0;37;40m                                [0;32;40m‚ñù‚ñÄ‚ñÄ         [0m[?25h"
)


# tokenizza una riga in escape CSI + caratteri singoli
tokenize() {
  local s=$1; local -n T=$2
  T=()
  while [[ -n $s ]]; do
    if [[ $s =~ ^(\[[0-9;]*m)(.*) ]]; then
      T+=( "${BASH_REMATCH[1]}" )
      s=${BASH_REMATCH[2]}
    else
      T+=( "${s:0:1}" )
      s=${s:1}
    fi
  done
}

print_with_cursor() {
  local line=$1
  local -a tokens
  local prefix=""  # qui accumulo in ordine escape+testo
  tokenize "$line" tokens

  for tok in "${tokens[@]}"; do
    prefix+="$tok"
    # se √® carattere visibile (non inizio con ESC[), faccio il frame
    if [[ ! $tok =~ ^\[ ]]; then
      printf '\r%s%s\e[K' "$prefix" "$cursor"
      read -t "$delay"
    fi
  done

  # frame finale (tutta la riga senza cursor)
  printf '\r%s\e[K\n' "$prefix"
}

# stampa a schermo
for L in "${lines[@]}"; do
  print_with_cursor "$L"
done

# ripristina cursore
printf '\e[?25h'
